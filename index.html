<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<title>HB Graphics — Honest (AI) & Infinite Games</title>
<style>
  *{box-sizing:border-box}
  body{margin:0;font-family:Segoe UI,Roboto,Arial,sans-serif;background:#f9f9f9;color:#222}
  header{background:#fff;padding:12px 18px;box-shadow:0 2px 6px rgba(0,0,0,.08);position:sticky;top:0;z-index:50;display:flex;align-items:center;gap:12px;justify-content:space-between}
  header h1{margin:0;color:#d2232a;font-size:1.25rem}
  #musicToggle{background:#00275e;color:#fff;border:0;padding:8px 12px;border-radius:8px;cursor:pointer;font-weight:700}
  nav{display:flex;justify-content:center;background:#00275e;padding:8px 6px;flex-wrap:wrap;gap:6px}
  nav a.nav-link{color:#fff;padding:8px 12px;border-radius:6px;font-weight:600;font-size:.95rem;background:transparent}
  nav a.nav-link.active,nav a.nav-link:hover{background:#d2232a}
  main{max-width:980px;margin:14px auto;padding:0 12px 80px}
  section{background:#fff;border-radius:10px;box-shadow:0 1px 8px rgba(0,0,0,.06);padding:14px 16px;margin-bottom:18px}
  h2{color:#00275e;margin:0 0 12px 0;font-size:1.15rem}
  #servicesContainer{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px}
  .service-card{background:#fafafa;border:1px solid #e8e8e8;padding:12px;border-radius:8px;display:flex;flex-direction:column;justify-content:space-between}
  .service-card h3{margin:0 0 8px 0;color:#d2232a}
  .contact-buttons{display:flex;gap:8px;margin-top:10px}
  .contact-buttons button{flex:1;border:0;border-radius:22px;padding:8px;background:#00275e;color:#fff;cursor:pointer;font-weight:700}
  .contact-buttons button:hover{background:#d2232a}
  #chatSection{display:flex;flex-direction:column;height:440px;max-height:70vh}
  #chatMessages{flex:1;overflow:auto;border:1px solid #dcdcdc;border-radius:10px;padding:10px;background:#fff}
  .message{max-width:85%;margin:8px 0;padding:8px 12px;border-radius:18px;word-break:break-word}
  .message.ai{background:#f2f2f2;align-self:flex-start;color:#111}
  .message.user{background:#d2232a;color:#fff;align-self:flex-end}
  #chatInputContainer{display:flex;gap:8px;margin-top:10px}
  #chatInput{flex:1;padding:10px 14px;border-radius:24px;border:1px solid #ccc;outline:none;font-size:1rem}
  #chatSendBtn{background:#d2232a;color:#fff;border:0;padding:10px 16px;border-radius:24px;cursor:pointer;font-weight:700}
  #chatContactButtons{margin-top:10px;display:flex;gap:8px;justify-content:center}
  #gameTabs{display:flex;flex-wrap:wrap;gap:8px;justify-content:center;margin-bottom:10px}
  #gameTabs button.nav-link{background:#00275e;color:#fff;padding:8px 12px;border-radius:22px;border:0;cursor:pointer}
  #gameTabs button.nav-link.active{background:#d2232a}
  #gameContainer{min-height:320px;padding:12px;border-radius:8px;background:#fff;box-shadow:0 1px 6px rgba(0,0,0,.05)}
  .game-section h3{margin:0 0 8px 0;color:#00275e}
  .level-indicator{font-weight:600;color:#555;margin-bottom:10px}
  .game-content .question{font-weight:700;margin-bottom:12px}
  .game-content .answers{display:flex;gap:10px;flex-wrap:wrap}
  .answer-btn{background:#ff8c00;color:#fff;border:2px solid rgba(0,0,0,.06);padding:10px 14px;border-radius:16px;cursor:pointer;font-weight:700;flex:1 1 45%;min-width:120px;transition:transform .12s,box-shadow .12s;text-align:center}
  .answer-btn:hover:not(:disabled){transform:translateY(-4px);box-shadow:0 8px 20px rgba(0,0,0,.12)}
  .answer-btn:disabled{opacity:.7;cursor:default}
  .answer-btn.correct{background:#28a745!important;box-shadow:0 0 12px rgba(40,167,69,.25)}
  .answer-btn.incorrect{background:#dc3545!important;box-shadow:0 0 12px rgba(220,53,69,.25)}
  #appreciation{text-align:center}
  .donation-buttons{margin-top:10px;display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
  .donation-buttons button{background:#00275e;color:#fff;border:0;padding:10px 16px;border-radius:22px;cursor:pointer;font-weight:700}
  .donation-buttons button:hover{background:#d2232a}
  @media(max-width:560px){.answer-btn{flex:1 1 100%;min-width:auto}.nav a.nav-link{font-size:.82rem;padding:6px 8px}header h1{font-size:1.05rem}}
</style>
</head>
<body>

<header>
  <div style="display:flex;align-items:center;gap:12px">
    <h1>HB Graphics — Honest (AI) & Learning Hub</h1>
  </div>
  <div style="display:flex;align-items:center;gap:8px">
    <button id="musicToggle">Enable Music</button>
    <label style="font-size:0.9rem;color:#555;margin-left:6px">Music off by default</label>
  </div>
</header>

<nav>
  <a class="nav-link active" href="#services">Services</a>
  <a class="nav-link" href="#chat">Chat with Honest</a>
  <a class="nav-link" href="#games">Games</a>
  <a class="nav-link" href="#appreciation">Appreciation</a>
</nav>

<main>
  <section id="services">
    <h2>Our Services</h2>
    <div id="servicesContainer"></div>
  </section>

  <section id="chat">
    <h2>Chat with Honest (voice + text)</h2>
    <div id="chatSection">
      <div id="chatMessages" aria-live="polite"></div>
      <div id="chatInputContainer">
        <input id="chatInput" type="text" placeholder="Type your question... (e.g. 'Tell me about logo design')" />
        <button id="chatSendBtn">Send</button>
      </div>
      <div id="chatContactButtons" style="display:none"></div>
    </div>
  </section>

  <section id="games">
    <h2>Learn with Infinite Games</h2>
    <div id="gameTabs" role="tablist"></div>
    <div id="gameContainer" role="region" aria-live="polite"></div>
  </section>

  <section id="appreciation">
    <h2>Appreciation & Support</h2>
    <p>If you appreciate HB Graphics and this learning platform, you can contact or appreciate the team below.</p>
    <div class="donation-buttons">
      <button onclick="window.open('https://wa.me/260776942402','_blank')">WhatsApp</button>
      <button onclick="location.href='mailto:hb4life40@gmail.com'">Email</button>
      <button onclick="alert('Mobile Money Number: 0776942402 (Honest Bulilu)')">Mobile Money</button>
    </div>
  </section>
</main>

<script>
/* ---------------------
   WebAudio ambient music
   - user must enable (browsers block autoplay)
   - simple layered soundscape generated programmatically
   --------------------- */
const AudioCtx = window.AudioContext || window.webkitAudioContext;
let audioCtx = null;
let musicNodes = [];
let musicPlaying = false;

function startAmbientMusic() {
  if(!AudioCtx) return;
  if(audioCtx && audioCtx.state === 'suspended') audioCtx.resume();
  if(!audioCtx) audioCtx = new AudioCtx();
  // prevent multiple starts
  if(musicPlaying) return;
  musicPlaying = true;

  // create ambient pad (two detuned saws through lowpass)
  const padGain = audioCtx.createGain(); padGain.gain.value = 0.08;
  const padOsc1 = audioCtx.createOscillator(); padOsc1.type = 'sawtooth'; padOsc1.frequency.value = 110;
  const padOsc2 = audioCtx.createOscillator(); padOsc2.type = 'sawtooth'; padOsc2.frequency.value = 112;
  const padLP = audioCtx.createBiquadFilter(); padLP.type = 'lowpass'; padLP.frequency.value = 600;
  padOsc1.connect(padLP); padOsc2.connect(padLP); padLP.connect(padGain); padGain.connect(audioCtx.destination);
  padOsc1.start(); padOsc2.start();

  // slow moving gentle noise/drone (via oscillator on low freq)
  const drGain = audioCtx.createGain(); drGain.gain.value = 0.02;
  const drOsc = audioCtx.createOscillator(); drOsc.type='sine'; drOsc.frequency.value=0.25; // LFO feel
  const drAmp = audioCtx.createGain(); drAmp.gain.value = 40;
  drOsc.connect(drAmp); drAmp.connect(padLP.frequency);
  drOsc.start();

  // soft subtle melody loop (scheduled)
  const melodyGain = audioCtx.createGain(); melodyGain.gain.value = 0.05; melodyGain.connect(audioCtx.destination);
  const melodyOsc = audioCtx.createOscillator(); melodyOsc.type = 'sine';
  melodyOsc.connect(melodyGain);
  melodyOsc.start();

  // schedule simple notes change every 1.6s
  let melodyIndex = 0;
  const notes = [220, 246.94, 196, 174.61]; // A, B, G, F
  const melodyTimer = setInterval(()=> {
    const n = notes[melodyIndex % notes.length];
    melodyOsc.frequency.setTargetAtTime(n, audioCtx.currentTime, 0.02);
    melodyIndex++;
  }, 1600);

  musicNodes = [padOsc1,padOsc2,drOsc,melodyOsc,padGain,drGain,melodyGain, padLP, melodyTimer];
}

function stopAmbientMusic() {
  if(!audioCtx || !musicPlaying) return;
  // stop oscillators and clear timers
  try {
    musicNodes.forEach(node=>{
      if(node && node.stop) {
        try { node.stop(); } catch(e){}
      }
      if(node && node.disconnect) {
        try { node.disconnect(); } catch(e){}
      }
    });
  } catch(e){}
  // clear scheduled timers
  musicNodes.forEach(n=>{ if(typeof n === 'number') clearInterval(n); });
  musicNodes = [];
  musicPlaying = false;
  // do not close audioCtx to allow resume
}

/* ---------------
   small utility tones for UI
   --------------- */
function playTone(freq=660,type='sine',dur=0.08,vol=0.06){
  if(!AudioCtx) return;
  if(!audioCtx) audioCtx = new AudioCtx();
  const o = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  o.type = type; o.frequency.value = freq;
  g.gain.value = vol;
  o.connect(g); g.connect(audioCtx.destination);
  o.start();
  o.stop(audioCtx.currentTime + dur);
}
function playClickSound(){ playTone(880,'sine',0.05,0.04); }
function playCorrectSound(){ playTone(880,'sine',0.06,0.07); setTimeout(()=>playTone(1320,'sine',0.08,0.06),80); }
function playWrongSound(){ playTone(200,'sawtooth',0.12,0.06); }

/* ----------------------------
   Services rendering
   ---------------------------- */
const services = [
  {name:"Graphic Design", description:"Logo design, flyers, brochures, business cards, branding materials, social media posts.", whatsapp:"https://wa.me/260776942402", email:"mailto:hb4life40@gmail.com"},
  {name:"Car Branding", description:"Vehicle wraps, decals, vinyl stickers for cars, trucks, and fleets.", whatsapp:"https://wa.me/260776942402", email:"mailto:hb4life40@gmail.com"},
  {name:"Shop Branding", description:"Signage, banners, window decals, promotional materials for shops.", whatsapp:"https://wa.me/260776942402", email:"mailto:hb4life40@gmail.com"},
  {name:"Office Branding", description:"Wall graphics, directional signs, nameplates, office event materials.", whatsapp:"https://wa.me/260776942402", email:"mailto:hb4life40@gmail.com"},
  {name:"Printing Services", description:"T-shirts, mugs, posters, business cards, brochures, custom printing.", whatsapp:"https://wa.me/260776942402", email:"mailto:hb4life40@gmail.com"},
  {name:"Laser Engraving", description:"Personalized gifts, awards, custom designs on wood, glass, and metal.", whatsapp:"https://wa.me/260776942402", email:"mailto:hb4life40@gmail.com"},
  {name:"Digital Marketing", description:"Social media management, content creation, online ads, and strategy.", whatsapp:"https://wa.me/260776942402", email:"mailto:hb4life40@gmail.com"},
  {name:"Social Media Account Management", description:"Managing your social pages to engage customers and grow your audience.", whatsapp:"https://wa.me/260776942402", email:"mailto:hb4life40@gmail.com"}
];

const servicesContainer = document.getElementById('servicesContainer');
services.forEach(s => {
  const card = document.createElement('div');
  card.className = 'service-card';
  card.innerHTML = `<h3>${s.name}</h3><p>${s.description}</p><div class="contact-buttons">
    <button onclick="window.open('${s.whatsapp}','_blank')">WhatsApp</button>
    <button onclick="window.open('${s.email}','_blank')">Email</button>
  </div>`;
  servicesContainer.appendChild(card);
});

/* ----------------------------
   Chat (Honest) - voice + text
   ---------------------------- */
const chatMessages = document.getElementById('chatMessages');
const chatInput = document.getElementById('chatInput');
const chatSendBtn = document.getElementById('chatSendBtn');
const chatContactButtons = document.getElementById('chatContactButtons');

function appendMessage(text,sender='ai'){
  const div = document.createElement('div');
  div.className = `message ${sender}`;
  div.textContent = text;
  chatMessages.appendChild(div);
  chatMessages.scrollTop = chatMessages.scrollHeight;
}

/* Find a male voice preference, fallback gracefully */
function findMaleVoice(){
  const voices = window.speechSynthesis.getVoices() || [];
  // list of likely male voice names or markers
  const maleCandidates = ['Male','male','Google UK English Male','Alex','Daniel','Tom','Google US English','Microsoft David','Ryan','Fred'];
  for(const name of maleCandidates){
    const v = voices.find(x => x && x.name && x.name.includes(name));
    if(v) return v;
  }
  // fallback: first English male-like voice or just first voice
  const en = voices.find(v => v.lang && v.lang.startsWith('en'));
  if(en) return en;
  return voices[0] || null;
}

function speakHonest(text){
  if(!('speechSynthesis' in window)) return;
  const utter = new SpeechSynthesisUtterance(text);
  const voice = findMaleVoice();
  if(voice) utter.voice = voice;
  utter.rate = 1;
  utter.pitch = 1;
  window.speechSynthesis.speak(utter);
}

/* Chat logic - simple built-in rules; shows contact buttons if fallback */
function showChatContacts(){
  if(chatContactButtons.childElementCount) return;
  chatContactButtons.style.display = 'flex';
  const w = document.createElement('button'); w.textContent='WhatsApp'; w.onclick=()=>window.open('https://wa.me/260776942402','_blank');
  const e = document.createElement('button'); e.textContent='Email'; e.onclick=()=>location.href='mailto:hb4life40@gmail.com';
  chatContactButtons.appendChild(w); chatContactButtons.appendChild(e);
}

async function getAIReply(message){
  const m = message.toLowerCase();
  if(m.includes('hello')||m.includes('hi')) return "Hello — I'm Honest, HB Graphics' assistant. How can I help you with design, printing, or engraving today?";
  if(m.includes('services')) return "We do logo design, vehicle/shop/office branding, printing, laser engraving, social media management and more. Which service do you need?";
  if(m.includes('logo')) return "For logos I recommend vector SVG for scalability. Tell me the style you want (minimal, modern, vintage).";
  if(m.includes('color')) return "Tell me the industry and mood (e.g. energetic, trustworthy) and I'll suggest color combinations.";
  if(m.includes('price')||m.includes('cost')||m.includes('quote')) return "Please tell me the service, size and quantity (e.g., 100 flyers A5, full color) so I can estimate.";
  if(m.includes('game')||m.includes('quiz')) return "Pick a quiz below — Graphic Design, Color Combinations, Coding and more. Want me to start one for you?";
  if(m.trim().length<2) return "Please write your request — I'm ready to help.";
  showChatContacts();
  return "I couldn't fully answer that. I'll share contact options so we can continue on WhatsApp or email.";
}

/* Handle send */
async function sendMessage(){
  const text = chatInput.value.trim();
  if(!text) return;
  appendMessage(text,'user');
  playClickSound();
  chatInput.value='';
  chatInput.disabled=true; chatSendBtn.disabled=true;
  appendMessage('Thinking...','ai');
  setTimeout(async ()=>{
    // remove last ai 'Thinking...' message
    const ais = chatMessages.querySelectorAll('.message.ai');
    if(ais.length) ais[ais.length-1].remove();
    const reply = await getAIReply(text);
    appendMessage(reply,'ai');
    speakHonest(reply);
    playToneForAI();
    chatInput.disabled=false; chatSendBtn.disabled=false; chatInput.focus();
  },600);
}
function playToneForAI(){ playTone(660,'sine',0.09,0.06); setTimeout(()=>playTone(880,'sine',0.08,0.05),90); }

chatSendBtn.addEventListener('click',sendMessage);
chatInput.addEventListener('keydown',e=>{ if(e.key==='Enter') sendMessage(); });

/* ----------------------------
   Games: multiple categories, infinite play
   ---------------------------- */
const allGames = {
  "Graphic Design":[
    {question:"Which software is popular for vector graphics?",answers:["Adobe Illustrator","Photoshop","InDesign","Premiere Pro"],correct:"Adobe Illustrator"},
    {question:"What does 'RGB' stand for?",answers:["Red Green Blue","Red Grey Black","Ready Go Build","Really Good Brand"],correct:"Red Green Blue"},
    {question:"Which format is best for logos?",answers:["SVG","JPEG","PNG","GIF"],correct:"SVG"},
    {question:"What is kerning?",answers:["Spacing between letters","Image resolution","Color saturation","Font style"],correct:"Spacing between letters"},
    {question:"Which color model is used for printing?",answers:["CMYK","RGB","HSV","LAB"],correct:"CMYK"}
  ],
  "Color Combinations":[
    {question:"Which color pairs strongly with red for contrast?",answers:["White","Purple","Brown","Pink"],correct:"White"},
    {question:"Safe neutral for bright colors:",answers:["Gray","Neon Green","Hot Pink","Bright Yellow"],correct:"Gray"},
    {question:"Red and gold usually communicate:",answers:["Luxury & energy","Calmness","Sadness","Coldness"],correct:"Luxury & energy"},
    {question:"Monochrome palette uses:",answers:["Different shades of same color","Many unrelated colors","Black only","White only"],correct:"Different shades of same color"}
  ],
  "Color Meaning":[
    {question:"Blue commonly communicates:",answers:["Trust & calm","Anger","Excitement","Pain"],correct:"Trust & calm"},
    {question:"Green often evokes:",answers:["Nature & growth","Fear","Luxury","Urgency"],correct:"Nature & growth"},
    {question:"Yellow typically signals:",answers:["Optimism & attention","Sadness","Danger only","Luxury"],correct:"Optimism & attention"},
    {question:"Black in branding means:",answers:["Elegance & power","Playfulness","Childishness","Honesty"],correct:"Elegance & power"}
  ],
  "Brand Color Suggestions":[
    {question:"Color for a health brand?",answers:["Green","Black","Red","Brown"],correct:"Green"},
    {question:"Color for a luxury brand?",answers:["Gold","Lime","Orange","Neon Pink"],correct:"Gold"},
    {question:"Color for a children's brand?",answers:["Bright multicolor","Dark gray","Olive","Burgundy"],correct:"Bright multicolor"}
  ],
  "Marketing & Branding":[
    {question:"What is a CTA?",answers:["Call To Action","Customer Tracking App","Content Target Audience","Click Through Average"],correct:"Call To Action"},
    {question:"Brand consistency is:",answers:["Same style across channels","Changing logo often","No logo at all","Multiple fonts randomly"],correct:"Same style across channels"},
    {question:"Conversion rate measures:",answers:["Visitors who take a desired action","Number of site pages","Total app installs","Total followers"],correct:"Visitors who take a desired action"}
  ],
  "Digital Marketing":[
    {question:"What is PPC?",answers:["Pay Per Click","Page Performance Check","Product Price Calculation","Public Paid Content"],correct:"Pay Per Click"},
    {question:"What is SEO?",answers:["Search Engine Optimization","Social Event Organizer","Sales Execution Order","Server Error Output"],correct:"Search Engine Optimization"},
    {question:"Which content performs best on social platforms?",answers:["Videos","Plain text only","PDFs","Audio files only"],correct:"Videos"}
  ],
  "Social Media Marketing":[
    {question:"Best platform for B2B reach?",answers:["LinkedIn","TikTok","Snapchat","Pinterest"],correct:"LinkedIn"},
    {question:"Engagement means:",answers:["Likes, comments & shares","Number of employees","Website uptime","Ad spend"],correct:"Likes, comments & shares"}
  ],
  "Logo Design Principles":[
    {question:"A good logo should be:",answers:["Simple & memorable","Extremely complex","Very colorful always","Text-only always"],correct:"Simple & memorable"},
    {question:"Why test a logo in black & white?",answers:["Check versatility","Because color doesn't matter","To hide details","To confuse customers"],correct:"Check versatility"}
  ],
  "Coding Languages":[
    {question:"Which language runs in the browser?",answers:["JavaScript","Python","C++","Java"],correct:"JavaScript"},
    {question:"Backend web servers often use?",answers:["Node.js/JavaScript","HTML","CSS","Markdown"],correct:"Node.js/JavaScript"}
  ],
  "Coding Techniques":[
    {question:"What is a loop used for?",answers:["Repeating code","Styling pages","Storing images","Compressing files"],correct:"Repeating code"},
    {question:"What does an 'if' statement do?",answers:["Conditional execution","Deletes files","Prints images","Creates databases"],correct:"Conditional execution"}
  ],
  "Machine Learning":[
    {question:"Supervised learning needs:",answers:["Labeled data","No data","Only audio","Only images"],correct:"Labeled data"},
    {question:"Overfitting means:",answers:["Model fits training data too well","Model never trains","Model is perfect","Model is random"],correct:"Model fits training data too well"}
  ],
  "Easy English":[
    {question:"Plural of 'child'?",answers:["Children","Childs","Childes","Child"],correct:"Children"},
    {question:"Past tense of 'go'?",answers:["Went","Goed","Gone","Going"],correct:"Went"}
  ]
};

const gameTabs = document.getElementById('gameTabs');
const gameContainer = document.getElementById('gameContainer');
let currentGameName = Object.keys(allGames)[0];
const totalQuestionsPerLevel = 10;
let gameState = { currentLevel:1, score:0, questionIndex:0 };

function shuffleArray(arr){ const copy = arr.slice(); for(let i=copy.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [copy[i],copy[j]]=[copy[j],copy[i]] } return copy; }

function renderGameTabs(){
  gameTabs.innerHTML='';
  Object.keys(allGames).forEach(name=>{
    const btn=document.createElement('button');
    btn.className='nav-link'+(name===currentGameName ? ' active':'' );
    btn.textContent=name;
    btn.onclick=()=>{ if(currentGameName!==name){ currentGameName=name; resetGame(); renderGame(); updateTabsActive(); } };
    gameTabs.appendChild(btn);
  });
}
function updateTabsActive(){ Array.from(gameTabs.children).forEach(b=>b.classList.toggle('active', b.textContent===currentGameName)); }
function resetGame(){ gameState.currentLevel=1; gameState.score=0; gameState.questionIndex=0; }

function pickRandomQuestion(category){ const pool = allGames[category]; return pool[Math.floor(Math.random()*pool.length)]; }

function renderGame(){
  if(gameState.questionIndex>0 && gameState.questionIndex%totalQuestionsPerLevel===0){
    gameContainer.innerHTML=`<div style="text-align:center"><h3>Level ${gameState.currentLevel} Completed!</h3><p>Your Score: ${gameState.score} / ${totalQuestionsPerLevel}</p><div style="margin-top:12px"><button id="nextLevelBtn" style="background:#28a745;color:#fff;border:0;padding:10px 16px;border-radius:10px;margin-right:10px;cursor:pointer;font-weight:700">Next Level</button><button id="restartBtn" style="background:#E50914;color:#fff;border:0;padding:10px 16px;border-radius:10px;cursor:pointer;font-weight:700">Restart</button></div></div>`;
    document.getElementById('nextLevelBtn').onclick=()=>{ gameState.currentLevel++; gameState.score=0; gameState.questionIndex=0; renderGame(); };
    document.getElementById('restartBtn').onclick=()=>{ resetGame(); renderGame(); };
    return;
  }

  const qObj = pickRandomQuestion(currentGameName);
  const answers = shuffleArray(qObj.answers);
  gameContainer.innerHTML=`<div class="game-section"><h3>${currentGameName} Quiz</h3><div class="level-indicator">Level: ${gameState.currentLevel} | Question: ${(gameState.questionIndex%totalQuestionsPerLevel)+1} / ${totalQuestionsPerLevel}</div><div class="game-content"><div class="question">${qObj.question}</div><div class="answers" id="answersRow"></div></div></div>`;
  const answersRow = document.getElementById('answersRow');
  answers.forEach(ans=>{
    const b=document.createElement('button'); b.className='answer-btn'; b.textContent=ans;
    b.onclick=()=>{
      if(b.disabled) return;
      playClickSound();
      Array.from(answersRow.children).forEach(ch=>ch.disabled=true);
      if(ans===qObj.correct){ b.classList.add('correct'); playCorrectSound(); gameState.score++; }
      else{ b.classList.add('incorrect'); playWrongSound(); Array.from(answersRow.children).forEach(ch=>{ if(ch.textContent===qObj.correct) ch.classList.add('correct');}); }
      setTimeout(()=>{ gameState.questionIndex++; renderGame(); }, 900);
    };
    answersRow.appendChild(b);
  });
}

/* initial UI */
renderGameTabs(); renderGame();

/* nav smooth scroll & highlight */
document.querySelectorAll('nav a.nav-link').forEach(link=>{
  link.addEventListener('click', e=>{
    e.preventDefault();
    const id = link.getAttribute('href').slice(1);
    const target = document.getElementById(id);
    if(target) target.scrollIntoView({behavior:'smooth',block:'start'});
    document.querySelectorAll('nav a.nav-link').forEach(a=>a.classList.remove('active'));
    link.classList.add('active');
  });
});

/* keyboard nav for tabs */
gameTabs.addEventListener('keydown',(e)=>{
  const buttons = Array.from(gameTabs.children);
  if(e.key==='ArrowRight' || e.key==='ArrowLeft'){
    e.preventDefault();
    let idx = buttons.findIndex(b=>b.classList.contains('active'));
    if(idx===-1) idx=0;
    idx = (e.key==='ArrowRight') ? (idx+1)%buttons.length : (idx-1+buttons.length)%buttons.length;
    buttons[idx].click();
  }
});

/* Welcome message & initial voice hint */
window.addEventListener('load',()=>{
  appendMessage("Hello — I'm Honest. Tap 'Chat with Honest' to ask me or pick any game to start learning!",'ai');
  setTimeout(()=>speakHonest("Hello, I'm Honest. Welcome to HB Graphics learning hub."),600);
});

/* enable music button */
const musicToggle = document.getElementById('musicToggle');
musicToggle.addEventListener('click', ()=>{
  if(!musicPlaying){
    // need user gesture to start audio
    startAmbientMusic();
    musicToggle.textContent='Disable Music';
    musicToggle.style.background='#a11a20';
  } else {
    stopAmbientMusic();
    musicToggle.textContent='Enable Music';
    musicToggle.style.background='#00275e';
  }
});

/* play short welcome tone on user gesture */
document.addEventListener('click', ()=>{ try{ if(audioCtx && audioCtx.state==='suspended') audioCtx.resume(); }catch(e){} }, {once:true});
</script>
</body>
</html>
